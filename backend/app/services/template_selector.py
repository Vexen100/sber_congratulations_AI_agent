from __future__ import annotations

from dataclasses import dataclass


@dataclass(frozen=True)
class TemplateChoice:
    tone: str
    subject_template: str
    body_template: str


def choose_template(*, segment: str, event_type: str, title: str) -> TemplateChoice:
    seg = (segment or "standard").lower()
    et = (event_type or "").lower()

    if et == "birthday":
        if seg == "vip":
            return TemplateChoice(
                tone="official",
                subject_template="Поздравляем с днём рождения, {first_name}!",
                body_template=(
                    "Уважаемый {first_name} {last_name},\n\n"
                    "От имени команды Сбербанка примите наши искренние поздравления с днём Вашего рождения! "
                    "Этот особенный день — прекрасный повод выразить Вам признательность за многолетнее сотрудничество и доверие.\n\n"
                    "Желаем Вам крепкого здоровья, неиссякаемой энергии, уверенных решений и ярких профессиональных достижений. "
                    "Пусть каждый новый год жизни будет наполнен успехами, гармонией и реализацией самых смелых планов.\n\n"
                    "Спасибо, что остаётесь с нами.\n\n"
                    "С уважением,\nКоманда Сбер"
                ),
            )
        return TemplateChoice(
            tone="warm",
            subject_template="{first_name}, с днём рождения!",
            body_template=(
                "{first_name},\n\n"
                "Поздравляем Вас с днём рождения! Этот особенный день — время для радости, подарков и приятных моментов в кругу близких.\n\n"
                "Пусть этот год принесёт Вам вдохновение, яркие успехи в делах и новые возможности для развития. "
                "Желаем здоровья, счастья, гармонии и чтобы каждый день был наполнен положительными эмоциями и добрыми событиями.\n\n"
                "Спасибо, что остаётесь с нами.\n\n"
                "С уважением,\nКоманда Сбер"
            ),
        )

    # Holiday / manual (fallback)
    if seg == "vip":
        return TemplateChoice(
            tone="official",
            subject_template="Поздравление: {title}",
            body_template=(
                "Уважаемый {first_name} {last_name},\n\n"
                "От имени команды Сбербанка поздравляем Вас с {title}! "
                "Этот праздник — важный момент в году, когда хочется выразить признательность и пожелать всего наилучшего.\n\n"
                "Желаем Вам стабильного роста, надёжных партнёров, успешной реализации всех планов и амбициозных проектов. "
                "Пусть впереди будет ещё больше возможностей для развития, достижений и приятных событий, которые приносят радость и удовлетворение.\n\n"
                "Спасибо, что остаётесь с нами.\n\n"
                "С уважением,\nКоманда Сбер"
            ),
        )

    return TemplateChoice(
        tone="warm",
        subject_template="Поздравляем: {title}",
        body_template=(
            "{first_name},\n\n"
            "Поздравляем Вас с {title}! Этот праздник наполнен особой атмосферой и теплом, и мы рады разделить с Вами эту радость.\n\n"
            "Пусть впереди будет больше сильных проектов, удачных решений и приятных событий, которые делают жизнь ярче и интереснее. "
            "Желаем здоровья, вдохновения, гармонии и чтобы каждый день приносил что-то новое и позитивное.\n\n"
            "Спасибо, что остаётесь с нами.\n\n"
            "С уважением,\nКоманда Сбер"
        ),
    )
